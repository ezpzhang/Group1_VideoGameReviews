"0",""
"0","#Do you understand NN check"
"0","#weightscritic <- modelcritic %>% get_weights()"
"0",""
"0","#round(modelcritic %>% predict(criticreview3_xtrain[1:5,]), 3)"
"0",""
"0","#cn5 <- 5"
"0",""
"0","# first layer: z_1 = W_1 X + b_1; a_1 = ReLU(z_1)"
"0","#cz_1 <- criticreview3_xtrain[1:cn5, ] %*% weightscritic[[1]] "
"0","# add beta (weights[[2]]) to every row "
"0","#cz_1 <- cz_1 + matrix(rep(weightscritic[[2]], cn5), nrow = cn5, byrow = T)"
"0","#ca_1 <- matrix(pmax(0, cz_1), nrow = cn5)"
"0",""
"0","# second layer: z_2 = W_2 a_1 + b_2; a_2 = ReLU(z_2)"
"0","#cz_2 <- ca_1 %*% weightscritic[[3]]"
"0","#cz_2 <- cz_2 + matrix(rep(weightscritic[[4]], cn5), nrow = cn5, byrow = T)"
"0","#ca_2 <- matrix(pmax(0,  cz_2), nrow = cn5)"
"0",""
"0","# output layer: Sigmoid(W_3 a_2 + b_3)"
"0","#cx.out <- as.numeric(ca_2 %*% weightscritic[[5]]) + weightscritic[[6]]"
"0","#cprob.pred <- 1 / (1 + exp(-cx.out)) "
"0",""
"0","#round(cprob.pred, 3)"
"0",""
"0","#Parameter Selection"
"0","fitcritic1$metrics$loss[10]"
"1","[1]"
"1"," 0.3918645"
"1","
"
"0","#prediction (Using Epoch 7)"
"0","#pcritic <- dim(criticreview3_xtrain)[2] # number of input variables"
"0",""
"0","#retain the nn:"
"0","modelcritic <- keras_model_sequential() %>%"
"0","  layer_dense(units = 16, activation = ""relu"", input_shape = c(pcritic)) %>% "
"0","  # 1 layer with 16 neurons. default activation is relu"
"0","  layer_dense(units = 8, activation = ""relu"") %>%  # layer 2 with 8 neurons"
"0","  layer_dense(units = 2, activation = ""softmax"") # output"
"0",""
"0","modelcritic %>% compile("
"0","  optimizer = ""rmsprop"","
"0","  loss = ""sparse_categorical_crossentropy"","
"0","  metrics = c(""accuracy"")"
"0",")"
"0",""
"0","modelcritic %>% fit(criticreview3_xtrain, criticreview3_ytrain, epochs = 26, batch_size = 512)"
"1","Epoch 1/26
1/1 [==============================] - 0s 229ms/step - loss: 0.6842 - accuracy: 0.6000
"
"1","1/1 [==============================] - 0s 229ms/step - loss: 0.6842 - accuracy: 0.6000
"
"1","Epoch 2/26
1/1 [==============================] - 0s 997us/step - loss: 0.6330 - accuracy: 0.8133
"
"1","1/1 [==============================] - 0s 997us/step - loss: 0.6330 - accuracy: 0.8133
"
"1","Epoch 3/26
1/1 [==============================] - 0s 0s/step - loss: 0.5955 - accuracy: 0.8533
"
"1","1/1 [==============================] - 0s 997us/step - loss: 0.5955 - accuracy: 0.8533
"
"1","Epoch 4/26
1/1 [==============================] - 0s 998us/step - loss: 0.5641 - accuracy: 0.8800
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.5641 - accuracy: 0.8800
"
"1","Epoch 5/26
1/1 [==============================] - 0s 959us/step - loss: 0.5357 - accuracy: 0.8800
"
"1","1/1 [==============================] - 0s 959us/step - loss: 0.5357 - accuracy: 0.8800
"
"1","Epoch 6/26
1/1 [==============================] - 0s 997us/step - loss: 0.5098 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 997us/step - loss: 0.5098 - accuracy: 0.9067
"
"1","Epoch 7/26
1/1 [==============================] - 0s 998us/step - loss: 0.4866 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.4866 - accuracy: 0.9067
"
"1","Epoch 8/26
1/1 [==============================] - 0s 997us/step - loss: 0.4650 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 997us/step - loss: 0.4650 - accuracy: 0.9067
"
"1","Epoch 9/26
1/1 [==============================] - 0s 998us/step - loss: 0.4449 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.4449 - accuracy: 0.9067
"
"1","Epoch 10/26
1/1 [==============================] - 0s 1ms/step - loss: 0.4264 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 2ms/step - loss: 0.4264 - accuracy: 0.9067
"
"1","Epoch 11/26
1/1 [==============================] - 0s 994us/step - loss: 0.4084 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 994us/step - loss: 0.4084 - accuracy: 0.9067
"
"1","Epoch 12/26
1/1 [==============================] - 0s 993us/step - loss: 0.3912 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 993us/step - loss: 0.3912 - accuracy: 0.9067
"
"1","Epoch 13/26
1/1 [==============================] - 0s 998us/step - loss: 0.3747 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.3747 - accuracy: 0.9067
"
"1","Epoch 14/26
1/1 [==============================] - 0s 998us/step - loss: 0.3594 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.3594 - accuracy: 0.9067
"
"1","Epoch 15/26
1/1 [==============================] - 0s 994us/step - loss: 0.3453 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 994us/step - loss: 0.3453 - accuracy: 0.9067
"
"1","Epoch 16/26
1/1 [==============================] - 0s 997us/step - loss: 0.3318 - accuracy: 0.9067
"
"1","1/1 [==============================] - 0s 997us/step - loss: 0.3318 - accuracy: 0.9067
"
"1","Epoch 17/26
1/1 [==============================] - 0s 997us/step - loss: 0.3190 - accuracy: 0.9200
"
"1","1/1 [==============================] - 0s 997us/step - loss: 0.3190 - accuracy: 0.9200
"
"1","Epoch 18/26
1/1 [==============================] - 0s 997us/step - loss: 0.3074 - accuracy: 0.9200
"
"1","1/1 [==============================] - 0s 997us/step - loss: 0.3074 - accuracy: 0.9200
"
"1","Epoch 19/26
1/1 [==============================] - 0s 998us/step - loss: 0.2960 - accuracy: 0.9333
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.2960 - accuracy: 0.9333
"
"1","Epoch 20/26
1/1 [==============================] - 0s 994us/step - loss: 0.2853 - accuracy: 0.9333
"
"1","1/1 [==============================] - 0s 994us/step - loss: 0.2853 - accuracy: 0.9333
"
"1","Epoch 21/26
1/1 [==============================] - 0s 998us/step - loss: 0.2753 - accuracy: 0.9333
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.2753 - accuracy: 0.9333
"
"1","Epoch 22/26
1/1 [==============================] - 0s 993us/step - loss: 0.2653 - accuracy: 0.9333
"
"1","1/1 [==============================] - 0s 993us/step - loss: 0.2653 - accuracy: 0.9333
"
"1","Epoch 23/26
1/1 [==============================] - 0s 998us/step - loss: 0.2559 - accuracy: 0.9333
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.2559 - accuracy: 0.9333
"
"1","Epoch 24/26
1/1 [==============================] - 0s 0s/step - loss: 0.2470 - accuracy: 0.9467
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.2470 - accuracy: 0.9467
"
"1","Epoch 25/26
1/1 [==============================] - 0s 998us/step - loss: 0.2385 - accuracy: 0.9467
"
"1","1/1 [==============================] - 0s 998us/step - loss: 0.2385 - accuracy: 0.9467
"
"1","Epoch 26/26
1/1 [==============================] - 0s 996us/step - loss: 0.2304 - accuracy: 0.9467
"
"1","1/1 [==============================] - 0s 996us/step - loss: 0.2304 - accuracy: 0.9467
"
"0","resultscritic <- modelcritic %>% evaluate(criticreview3_xval, criticreview3_yval) ; resultscritic"
"1","1/1 [==============================] - 0s 53ms/step - loss: 0.3345 - accuracy: 0.9062
"
"1","1/1 [==============================] - 0s 54ms/step - loss: 0.3345 - accuracy: 0.9062
"
"1","     loss "
"1"," accuracy "
"1","
"
"1","0.3344616 "
"1","0.9062500 "
"1","
"
"0","#loss of 0.2804 and accuracy of 0.9062"
"0","#prediction user"
"0",""
"0","modelcritic %>% predict(criticreview3_xval[1:5,])"
"1","    "
"1","       [,1]"
"1","      [,2]"
"1","
[1,]"
"1"," 0.11481059"
"1"," 0.8851894"
"1","
[2,]"
"1"," 0.23413800"
"1"," 0.7658620"
"1","
[3,]"
"1"," 0.08250505"
"1"," 0.9174950"
"1","
[4,]"
"1"," 0.37906280"
"1"," 0.6209372"
"1","
[5,]"
"1"," 0.20381382"
"1"," 0.7961861"
"1","
"
"0","ycritic_pred <- ifelse(modelcritic %>% predict(criticreview3_xval[1:5,]) > .5, 1, 0)"
"0",""
"0","data.frame(yhat=ycritic_pred, y=criticreview3_yval[1:5, 1])"
